!function(e){var t,i,n,a={consts:{FULL:"full",LOCAL:"local"},models:{c:Fiverr.models.context,b:Fiverr.models.browser,user:Fiverr.models.user,notifications:{url:"",boundClearMarks:!1,bindClearMarksRetryCount:0},fiverrFavicon:{pinned:"//assetsv2.fiverrcdn.com/assets/v2_realtime/favicon-notif-ad052f660a1c23f2f5fc1a3852698b98.gif",main:"/favicon.ico"}},selectors:{},init:function(){if(!i.b.isMobileResponsive){n.$favicon=e('link[rel*="icon"]');var a=t.getMarkedStatuses(),r=(new Date).getTime();a&&a.expires>r&&(useNewCounter=!1),this.updateCounter(t.consts.FULL),this.bindClearMarksOnClick()}},getMarkedStatuses:function(){return ft.utl.getLS("header_data_markers")},updateFavicon:function(e){n.$favicon.prop("href",e?i.fiverrFavicon.pinned:i.fiverrFavicon.main)},anyUnseenStatus:function(e){if(Fiverr.models.ps.fiverrRealTimeEnabled&&e){var i=e.markStatuses||null,n=e.mode||t.consts.FULL;if(!i){var a=t.getMarkedStatuses();if(!a)return;i=a.markedStatuses}var r=0,o=!1,s=!1;_.forOwn(i,function(e,t){return e?!1:void r++}),o=_.size(i)!==r,s&&t.updateFavicon(o),n===t.consts.FULL&&Fiverr._syncState({pinned:!0})}},updateCounter:function(i){var n=e(".js-mark"),i=i,r=(new Date).getTime(),o={notifications:!1,inbox:!1,todos:!1},s=function(i,n,a){i.length&&n&&(e.each(n,function(e,t){t?i.filter('[data-mark="'+e+'"]').addClass("marked"):i.filter('[data-mark="'+e+'"]').removeClass("marked")}),t.anyUnseenStatus({markStatuses:n,mode:a}))};if(!document.pageScope.hidePinnedFlashes){if(i===t.consts.LOCAL){var l=t.getMarkedStatuses();l&&s(n,l.markedStatuses,i)}else e.ajax({type:"get",url:"/header_data",dataType:"text",success:function(t){try{t=e.parseJSON(t)}catch(l){return setTimeout(function(){a.updateCounter(i)},6e4)}o.notifications=t.notifications_unseen,o.inbox=t.inbox_unseen,o.notifications&&!o.inbox&&(o.inbox=t.notifications_unseen),s(n,o,i),ft.utl.setLS("header_data_markers",{expires:r+6e4,markedStatuses:o})}});a.bindClearMarksOnClick()}},bindClearMarksOnClick:function(){var n=e(".js-mark").filter(function(){return-1===["notifications","inbox"].indexOf(e(this).data("mark"))}).find("> a"),r=t.getMarkedStatuses(),o=r?r.markedStatuses:!1;i.notifications.boundClearMarks||(o?(i.notifications.boundClearMarks=!0,n.on("click",function(i){i.preventDefault();var n=e(this),a=n.attr("href"),r=n.closest(".js-mark"),s=r.data("mark"),l=((new Date).getTime(),t.getMarkedStatuses());l&&(o=l.markedStatuses),o[s]=!1,ft.utl.setLS("header_data_markers",{expires:l.expires,markedStatuses:o}),t.anyUnseenStatus({markedStatuses:o,mode:t.consts.LOCAL}),r.removeClass("marked"),_.delay(function(){document.location.href=a},100)})):i.notifications.bindClearMarksRetryCount<=5&&_.delay(function(){a.bindClearMarksOnClick(),a.models.notifications.bindClearMarksRetryCount++},300))}};t=a,i=t.models,n=t.selectors,window.fNotifications=a,Fiverr.models.user&&a.init()}(jQuery),function(){var e={admin_cancelled_buyer:{group:"fullGig"},seller_blocked_cancellation:{group:"fullGig"},seller_account_deleted_cancellation:{group:"fullGig"},blocked_seller_delivered_order:{group:"fullGig"},seller_account_deleted_delivered_order:{group:"fullGig"},blocked_or_deleted_seller_delivered_order:{group:"fullGig"},admin_cancelled_seller:{group:"fullGig"},auto_completed:{group:"fullGig"},buyer_extend_auto_completion_time:{group:"fullGig"},seller_extend_auto_completion_time:{group:"fullGig"},completed_by_seller:{group:"fullGig"},buyer_accepted_proposal:{group:"fullGig"},buyer_nudge:{group:"fullGig"},buyer_nudge_new_notifier:{group:"fullGig"},order_autocomplete_first_notice:{group:"fullGig"},order_autocompleted:{group:"fullGig"},provide_requirements_reminder:{group:"fullGig"},completed:{group:"fullGig"},completed_with_positive_review:{group:"fullGig"},custom:{customContent:!0,icon:"present"},delivered:{group:"fullGig"},delivered_new_notifier:{group:"fullGig"},redelivered_new_notifier:{group:"fullGig"},upsell_offered:{group:"fullGig"},seller_review_order_requirements:{group:"fullGig"},delivery_extended_autocomplete_time_to_seller:{icon:"bell"},deny_user_notif:{gigImage:!0,icon:"times",subCat:!0},featured_promotion:{gigImage:!0,icon:"ribbon",subCat:!0},free_gig:{icon:"present"},handle_buyer_cancellation:{group:"fullGig"},handle_seller_cancellation:{group:"fullGig"},seller_fiverr_choice_order_started:{group:"fullGig"},handle_waiting_for_reqs:{group:"fullGig"},in_progress:{group:"fullGig"},in_progress_item:{group:"fullGig"},new_payment_milestone_ordered:{group:"fullGig"},in_progress_with_reqs:{group:"fullGig"},new_levels_system_notification:{icon:"ribbon"},level_up_notification:{icon:"ribbon"},level_down_notification:{icon:"ribbon"},level_trs_nominated_notification:{icon:"ribbon"},level_trs_kept_notification:{icon:"ribbon"},level_two_kept_notification:{icon:"ribbon"},try_live:{icon:"bell"},mutual_cancellation_request:{group:"fullGig"},mutual_cancellation_request_accepted:{group:"fullGig"},new_offer_notification_for_buyer:{group:"fullGig"},buyer_brief_notification_for_buyer_multi:{icon:"docs"},buyer_brief_notification_for_buyer_single:{icon:"docs"},buyer_brief_notification_for_buyer:{icon:"docs"},new_order_message:{gigImage:!0,userImage:!0,subCat:!0,textLong:!0},new_order_waiting_for_reqs_to_seller:{group:"fullGig"},new_user_notification:{icon:"docs"},order_created_mobile_notification_to_seller:{group:"fullGig"},order_resolution_no_reply_initiator:{group:"fullGig"},order_resolution_no_reply_responder:{group:"fullGig"},order_resolution_opened:{group:"fullGig"},order_resolution_opened_modify_feedback:{group:"fullGig"},order_resolution_reply_add_revisions_accepted:{group:"fullGig"},order_resolution_reply_add_revisions_declined:{group:"fullGig"},order_resolution_reply_extend_delivery_accepted:{group:"fullGig"},order_resolution_reply_extend_delivery_declined:{group:"fullGig"},order_resolution_reply_modify_feedback_accepted:{group:"fullGig"},order_resolution_reply_modify_feedback_declined:{group:"fullGig"},order_resolution_reply_modify_order_accepted:{group:"fullGig"},order_resolution_reply_modify_order_declined:{group:"fullGig"},order_resolution_reply_mutual_cancellaton_accepted:{group:"fullGig"},order_resolution_reply_mutual_cancellaton_declined:{group:"fullGig"},order_resolution_reply_personal_message_accepted:{group:"fullGig"},order_resolution_reply_personal_message_declined:{group:"fullGig"},order_resolution_reply_progress_update_submitted:{group:"fullGig"},order_resolution_withdrawn:{group:"fullGig"},order_updates:{group:"fullGig"},seller_order_complete_eligibility:{group:"fullGig"},seller_order_completed_makers_diy:{group:"fullGig"},prompt_user_change_password:{icon:"docs"},pro_seller_account_created:{icon:"docs"},welcome_back_from_ooo_mode:{icon:"suitcase"},your_seller_is_back_from_ooo_mode:{group:"fullGig"},gig_pro_toggled_on:{gigImage:!0,icon:"docs"},gig_pro_toggled_off:{gigImage:!0,icon:"docs"},redelivered:{group:"fullGig"},rejected:{group:"fullGig"},request_paused:{icon:"docs"},request_unapproved:{icon:"times"},shopping_balance_deposit:{icon:"present"},shopping_balance_deposit_pending:{icon:"present"},shopping_balance_deposit_share:{icon:"present"},soft_deny_user_notif:{gigImage:!0,icon:"pencil",subCat:!0},team_member_added:{icon:"docs"},tip_notification_for_seller:{group:"fullGig"},audio_file_deny:{gigImage:!0,icon:"pencil",subCat:!0},optional_phone_verification:{icon:"phone",customAction:!0},seller_skipped_requirements:{group:"fullGig"},available_now_time_left_reminder:{userImage:!0},byob_user_notification:{icon:"present"},profile_image_not_unique_warning:{icon:"pencil"},profile_image_not_unique_deleted:{icon:"pencil"},business_accounts_team_invitation_created:{icon:"team"},business_accounts_team_invitation_accepted_invitor:{icon:"member"},business_accounts_team_invitation_accepted_invitee:{icon:"team"},workspaces_team_invitation_created:{icon:"team"},workspaces_team_invitation_accepted:{icon:"member"},business_invitation_accepted:{icon:"team"},business_project_created:{icon:"team"},business_project_reactivated:{icon:"team"},business_project_archived:{icon:"team"},business_project_deleted:{icon:"team"},business_project_renamed:{icon:"team"},business_project_member_added:{icon:"member"},business_project_member_removed:{icon:"member"},business_policy_purchase_request_created:{icon:"member",userImage:!0},business_policy_purchase_request_approved:{icon:"member",userImage:!0,gigImage:!0},business_policy_add_payment_method_request_created:{icon:"member",userImage:!0},business_policy_add_payment_method_request_approved:{icon:"member",userImage:!0,gigImage:!0},business_admin_assigned:{icon:"bell"},business_financial_manager_assigned:{icon:"bell"},business_member_assigned:{icon:"bell"},business_order_created:{icon:"team"},and_co_announcement:{icon:"present"},buyer_profile_reminder:{icon:"form"},external_source_notification:{dynamicIcon:!0},admin_moved_gig:{icon:"pencil"},notify_user_on_referral_registration:{icon:"present"},id_verification_passed:{icon:"bell"},id_verification_failed:{icon:"bell"},id_verification_restrict_user_multiple_attempts:{icon:"bell"},id_verification_restrict_user_verification_period_expired:{icon:"bell"},id_verification_indecisive_try_again:{icon:"bell"},id_verification_indecisive_max_tries:{icon:"bell"},id_verification_document_unrecognized:{icon:"bell"},id_verification_low_quality:{icon:"bell"},id_verification_non_id:{icon:"bell"},trigger_id_verification:{icon:"bell"},eligible_for_deposit_with_cc:{icon:"bell"},seller_order_started_acknowledgement:{group:"fullGig"},seo_restructure_announcement:{icon:"pencil"},gig_handpicked:{icon:"ribbon"},seller_delivery_reminder:{group:"fullGig"},delayed_private_review:{icon:"pencil"},hidden_buying_review_created:{group:"fullGig"},late_delivery_notification_to_seller:{group:"fullGig"},very_late_delivery_notification_to_seller:{group:"fullGig"},attachment_review_comments_submitted:{group:"fullGig"},external_attachment_review_comments_submitted:{gigImage:!0,subCat:!0},mfa_verification:{icon:"bell"},fiverr_credits_removed:{icon:"bell"},fiverr_credits_removed_no_date:{icon:"bell"},localized_fiverr_credits_removed:{icon:"bell"},localized_fiverr_credits_removed_no_date:{icon:"bell"},studio_invite_member:{gigImage:!0,userImage:!0},studio_member_joined:{gigImage:!0,userImage:!0},studio_member_declined:{gigImage:!0,userImage:!0},studio_gig_publishable:{gigImage:!0},studio_revoke_member:{gigImage:!0,userImage:!0},studio_order_payment_cleared:{icon:"bell",gigImage:!0},studio_member_unavailable:{gigImage:!0,userImage:!0},studio_order_started:{group:"studioOrder"},studio_order_cancelled:{group:"studioOrder"},studio_order_completed:{group:"studioOrder"},studio_order_tipped:{group:"studioOrder"},business_chat_added:{icon:"bell"},seller_complete_gig_information:{icon:"bell",gigImage:!0},tax_form_notice:{icon:"bell"},tax_form_pause_gigs_notice:{icon:"bell"},tax_form_pending_validation_notice:{icon:"bell"},tax_form_completed_notice:{icon:"bell"},tax_form_failed_notice:{icon:"bell"},tax_form_answer_reminder:{icon:"bell"},india_tax_seller_policy_initiated:{icon:"bell"},india_tax_seller_policy_expired:{icon:"bell"},india_tax_seller_policy_completed:{icon:"bell"},collections_created_list:{userImage:!0},collections_share_with_team:{userImage:!0},collections_deleted_list:{userImage:!0},collections_edited_name:{userImage:!0},collections_added_gig:{gigImage:!0},collections_added_seller:{userImage:!0},collections_removed_gig:{gigImage:!0},collections_removed_seller:{userImage:!0},start_next_milestone_first_reminder_to_buyer:{group:"fullGig"},start_next_milestone_first_reminder_to_seller:{group:"fullGig"},new_subscription_order_seller:{group:"fullGig"},subscription_payment_failed:{group:"fullGig"},subscription_subsequent_order_created_buyer:{group:"fullGig"},subscription_subsequent_order_created_seller:{group:"fullGig"},subscription_payment_failed_reminder:{group:"fullGig"},seller_coupon_notice:{userImage:!0},remaining_coupon_quota_singular:{icon:"bell"},remaining_coupon_quota_plural:{icon:"bell"},coupon_quota_refill:{icon:"bell"},seller_plus_enrollment_started:{icon:"bell"},seller_plus_enrollment_ended:{icon:"bell"},workspace_earnings_exported:{icon:"bell"},promoted_gigs_unpromotable:{icon:"bell"},promoted_gigs_promotable_not_promoting:{icon:"bell"},promoted_gigs_promotable_promoting_single:{icon:"bell"},promoted_gigs_promotable_promoting_multi:{icon:"bell"},promoted_gigs_high_quality_sellers:{icon:"bell"},gig_gallery_tagging:{icon:"bell"},inbox_recommendations_dead_end:{icon:"bell"},buyer_requests_seller_notification:{icon:"bell"},brief_one_to_one_rejected_by_moderation:{icon:"bell"},brief_one_to_one_rejected_by_objectionable_content:{icon:"bell"},brief_one_to_one_rejected_by_product_violation:{icon:"bell"},brief_one_to_one_rejected_by_prohibited_services:{icon:"bell"},offer_milestones_after_custom_offer:{icon:"bell"},delivered_order_buyer_autocompletion_reminder:{group:"fullGig"},post_order_cross_gig_recommendations:{icon:"bell"},seller_moderation_reason_multiple_reasons:{icon:"bell"},seller_moderation_reason_fiverr_badges:{icon:"bell"},seller_moderation_reason_unrepresentative_personal_photo:{icon:"bell"},seller_moderation_reason_copyright_violation:{icon:"bell"},seller_moderation_reason_contact_information:{icon:"bell"},seller_moderation_reason_objectionable_content:{icon:"bell"},seller_moderation_reason_prohibited_services:{icon:"bell"},blocked_seller_can_join_program:{icon:"bell"},certified_brief_created:{icon:"bell"},selling_eligibility_not_eligible:{icon:"bell"},list_gigs_on_fib_marketplace:{icon:"bell"},expert_consultation_form:{icon:"bell"},budget_recommendations:{icon:"bell"}},t={fullGig:{gigImage:!0,userImage:!0,subCat:!0},studioOrder:{gigImage:!0,studioImage:!0}},i=function(i){if(!e[i])return null;var n=_.extend({},e[i]);if(n.hasOwnProperty("group")){var a=n.group;_.extend(n,t[a]),delete n.group}return n};window.notificationConfiguration=i}(),this.Fiverr=this.Fiverr||{},this.Fiverr.Templates=this.Fiverr.Templates||{},Handlebars.registerPartial("notification-aside-basic",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a;return"<aside>\n"+(null!=(a=this.invokePartial(i["notification-toggle-read"],e,{name:"notification-toggle-read",data:n,indent:"    ",helpers:t,partials:i}))?a:"")+"</aside>\n"},usePartial:!0,useData:!0})),Handlebars.registerPartial("notification-aside-with-close",Handlebars.template({1:function(e,t,i,n){var a;return'        <div class="preview-image" style="background-image:url('+this.escapeExpression(this.lambda(null!=(a=null!=e?e.images:e)?a.gig:a,e))+')"></div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a;return'<aside>\n    <nav>\n        <a href="#!" class="btn-close js-btn-close">&times;</a>\n    </nav>\n'+(null!=(a=t["if"].call(e,null!=(a=null!=e?e.images:e)?a.gig:a,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?a:"")+"</aside>\n"},useData:!0})),Handlebars.registerPartial("notification-aside-with-image",Handlebars.template({1:function(e,t,i,n){var a;return'        <div class="preview-image" style="background-image:url('+this.escapeExpression(this.lambda(null!=(a=null!=e?e.images:e)?a.gig:a,e))+')"></div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a;return"<aside>\n"+(null!=(a=this.invokePartial(i["notification-toggle-read"],e,{name:"notification-toggle-read",data:n,indent:"    ",helpers:t,partials:i}))?a:"")+(null!=(a=t["if"].call(e,null!=(a=null!=e?e.images:e)?a.gig:a,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?a:"")+"</aside>\n"},usePartial:!0,useData:!0})),Handlebars.registerPartial("notification-date",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a,r,o=t.helperMissing;return'<time datetime="'+this.escapeExpression((r=null!=(r=t.updatedAt||(null!=e?e.updatedAt:e))?r:o,"function"==typeof r?r.call(e,{name:"updatedAt",hash:{},data:n}):r))+'">'+(null!=(a=(t.howLongAgo||e&&e.howLongAgo||o).call(e,null!=e?e.updatedAt:e,!0,{name:"howLongAgo",hash:{},data:n}))?a:"")+"</time>\n"},useData:!0})),Handlebars.registerPartial("notification-footer-basic",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a;return"<footer>\n"+(null!=(a=this.invokePartial(i["notification-date"],e,{name:"notification-date",data:n,indent:"    ",helpers:t,partials:i}))?a:"")+"</footer>\n"},usePartial:!0,useData:!0})),Handlebars.registerPartial("notification-footer-with-subcat",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a,r=this.lambda,o=this.escapeExpression;return"<footer>\n    "+(null!=(a=this.invokePartial(i["notification-date"],e,{name:"notification-date",data:n,helpers:t,partials:i}))?a:"")+'<span class="sub-category">'+o(r(null!=(a=null!=e?e.params:e)?a.sub_category:a,e))+'</span><span class="status hint--left" data-hint="'+(null!=(a=(t.deHyphenate||e&&e.deHyphenate||t.helperMissing).call(e,null!=(a=null!=e?e.params:e)?a.order_status:a,"-"," ",{name:"deHyphenate",hash:{},data:n}))?a:"")+'"><span class="icn-status '+o(r(null!=(a=null!=e?e.params:e)?a.order_status:a,e))+'"></span></span>\n</footer>\n'},usePartial:!0,useData:!0})),Handlebars.registerPartial("notification-icon",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a;return'<figure>\n    <div class="notification-icon '+this.escapeExpression((a=null!=(a=t.iconName||(null!=e?e.iconName:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"iconName",hash:{},data:n}):a))+'"></div>\n</figure>\n'},useData:!0})),Handlebars.registerPartial("notification-toggle-read",Handlebars.template({1:function(e,t,i,n){return'        <a href="#!" class="mark-unread hint--bottom" data-hint="'+this.escapeExpression((t.getI18nText||e&&e.getI18nText||t.helperMissing).call(e,"notifications.mark_as_unread",{name:"getI18nText",hash:{},data:n}))+'"></a>\n'},3:function(e,t,i,n){var a,r=t.helperMissing;return'        <a href="#!" class="mark-read hint--bottom" data-hint="'+this.escapeExpression((t.getI18nText||e&&e.getI18nText||r).call(e,"notifications.mark_as_read",{name:"getI18nText",hash:{},data:n}))+'"></a>\n'+(null!=(a=(t.ifAboveGoal||e&&e.ifAboveGoal||r).call(e,null!=e?e.unreadCount:e,1,{name:"ifAboveGoal",hash:{},fn:this.program(4,n,0),inverse:this.noop,data:n}))?a:"")},4:function(e,t,i,n){var a;return'            <span class="unread-count">'+this.escapeExpression((a=null!=(a=t.unreadCount||(null!=e?e.unreadCount:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"unreadCount",hash:{},data:n}):a))+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a;return"<nav>\n"+(null!=(a=t["if"].call(e,null!=e?e.isRead:e,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.program(3,n,0),data:n}))?a:"")+"</nav>\n"},useData:!0})),Handlebars.registerPartial("notification-user-image",Handlebars.template({1:function(e,t,i,n){return' class="online"'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a;return"<figure"+(null!=(a=t["if"].call(e,null!=e?e.isOnline:e,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?a:"")+'>\n    <span class="user-pict-55">'+(null!=(a=this.lambda(null!=(a=null!=e?e.images:e)?a.user:a,e))?a:"")+"</span>\n</figure>\n"},useData:!0})),this.Fiverr.Templates["notifications/inbox-drawer-item"]=Handlebars.template({1:function(e,t,i,n){return" unread"},3:function(e,t,i,n){var a;return'<a href="'+this.escapeExpression((a=null!=(a=t.url||(null!=e?e.url:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"url",hash:{},data:n}):a))+'" class="js-main-action"></a>'},5:function(e,t,i,n){return this.escapeExpression((t.getI18nText||e&&e.getI18nText||t.helperMissing).call(e,"notifications.me",{name:"getI18nText",hash:{},data:n}))+" "},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a,r,o=t.helperMissing,s="function",l=this.escapeExpression;return'<li class="inbox-message drawer-item'+(null!=(a=t.unless.call(e,null!=e?e.isRead:e,{name:"unless",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?a:"")+'" data-id="'+l((r=null!=(r=t.id||(null!=e?e.id:e))?r:o,typeof r===s?r.call(e,{name:"id",hash:{},data:n}):r))+'">\n    '+(null!=(a=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(3,n,0),inverse:this.noop,data:n}))?a:"")+"\n"+(null!=(a=this.invokePartial(i["notification-aside-basic"],e,{name:"notification-aside-basic",data:n,indent:"    ",helpers:t,partials:i}))?a:"")+(null!=(a=this.invokePartial(i["notification-user-image"],e,{name:"notification-user-image",data:n,indent:"    ",helpers:t,partials:i}))?a:"")+'    <div class="content">\n        <header>\n            <strong>'+l((r=null!=(r=t.username||(null!=e?e.username:e))?r:o,typeof r===s?r.call(e,{name:"username",hash:{},data:n}):r))+"</strong>\n        </header>\n        <p>"+(null!=(a=t["if"].call(e,null!=e?e.isSender:e,{name:"if",hash:{},fn:this.program(5,n,0),inverse:this.noop,data:n}))?a:"")+l((r=null!=(r=t.snippet||(null!=e?e.snippet:e))?r:o,typeof r===s?r.call(e,{name:"snippet",hash:{},data:n}):r))+"</p>\n"+(null!=(a=this.invokePartial(i["notification-footer-basic"],e,{name:"notification-footer-basic",data:n,indent:"        ",helpers:t,partials:i}))?a:"")+"    </div>\n</li>\n"},usePartial:!0,useData:!0}),this.Fiverr.Templates["notifications/live-tray-inbox-item"]=Handlebars.template({1:function(e,t,i,n){return" gig-image"},3:function(e,t,i,n){var a;return'<a href="'+this.escapeExpression((a=null!=(a=t.url||(null!=e?e.url:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"url",hash:{},data:n}):a))+'" class="js-main-action"></a>'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a,r,o=t.helperMissing,s="function",l=this.escapeExpression;return'<li class="inbox-message drawer-item unread'+(null!=(a=t["if"].call(e,null!=(a=null!=e?e.images:e)?a.gig:a,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?a:"")+'" data-id="'+l((r=null!=(r=t.id||(null!=e?e.id:e))?r:o,typeof r===s?r.call(e,{name:"id",hash:{},data:n}):r))+'">\n    '+(null!=(a=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(3,n,0),inverse:this.noop,data:n}))?a:"")+"\n"+(null!=(a=this.invokePartial(i["notification-aside-with-close"],e,{name:"notification-aside-with-close",data:n,indent:"    ",helpers:t,partials:i}))?a:"")+(null!=(a=this.invokePartial(i["notification-user-image"],e,{name:"notification-user-image",data:n,indent:"    ",helpers:t,partials:i}))?a:"")+'    <div class="content">\n        <header>\n            <strong>'+l((r=null!=(r=t.username||(null!=e?e.username:e))?r:o,typeof r===s?r.call(e,{name:"username",hash:{},data:n}):r))+"</strong>\n        </header>\n        <p>"+l((r=null!=(r=t.snippet||(null!=e?e.snippet:e))?r:o,typeof r===s?r.call(e,{name:"snippet",hash:{},data:n}):r))+"</p>\n    </div>\n</li>\n"},usePartial:!0,useData:!0}),this.Fiverr.Templates["notifications/live-tray-notifications-item"]=Handlebars.template({1:function(e,t,i,n){return" gig-image"},3:function(e,t,i,n){var a;return'<a href="'+this.escapeExpression((a=null!=(a=t.url||(null!=e?e.url:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"url",hash:{},data:n}):a))+'" class="js-main-action"></a>'},5:function(e,t,i,n){var a;return null!=(a=this.invokePartial(i["notification-user-image"],e,{name:"notification-user-image",data:n,indent:"        ",helpers:t,partials:i}))?a:""},7:function(e,t,i,n){var a;return null!=(a=this.invokePartial(i["notification-icon"],e,{name:"notification-icon",data:n,indent:"        ",helpers:t,partials:i}))?a:""},9:function(e,t,i,n){var a,r=this.lambda;return'            <p class="text-long"><strong>'+(null!=(a=r(null!=(a=null!=e?e.params:e)?a.user:a,e))?a:"")+'</strong>: "'+this.escapeExpression(r(null!=(a=null!=e?e.params:e)?a.message_content:a,e))+'"</p>\n'},11:function(e,t,i,n){var a;return'            <p class="'+(null!=(a=this.lambda(null!=(a=null!=e?e.params:e)?a["class"]:a,e))?a:"")+'">'+(null!=(a=(t.hasPartial||e&&e.hasPartial||t.helperMissing).call(e,"customContent",{name:"hasPartial",hash:{},fn:this.program(12,n,0),inverse:this.program(14,n,0),data:n}))?a:"")+"</p>\n"},12:function(e,t,i,n){var a;return null!=(a=this.lambda(null!=(a=null!=e?e.params:e)?a.content:a,e))?a:""},14:function(e,t,i,n){var a,r;return null!=(r=null!=(r=t.notificationContent||(null!=e?e.notificationContent:e))?r:t.helperMissing,a="function"==typeof r?r.call(e,{name:"notificationContent",hash:{},data:n}):r)?a:""},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a,r,o=t.helperMissing;return'<li class="notifications-message drawer-item unread'+(null!=(a=t["if"].call(e,null!=(a=null!=e?e.images:e)?a.gig:a,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?a:"")+'" data-id="'+this.escapeExpression((r=null!=(r=t.id||(null!=e?e.id:e))?r:o,"function"==typeof r?r.call(e,{name:"id",hash:{},data:n}):r))+'">\n    '+(null!=(a=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(3,n,0),inverse:this.noop,data:n}))?a:"")+"\n"+(null!=(a=this.invokePartial(i["notification-aside-with-close"],e,{name:"notification-aside-with-close",data:n,indent:"    ",helpers:t,partials:i}))?a:"")+(null!=(a=(t.hasPartial||e&&e.hasPartial||o).call(e,"userImage",{name:"hasPartial",hash:{},fn:this.program(5,n,0),inverse:this.program(7,n,0),data:n}))?a:"")+'    <div class="content">\n'+(null!=(a=(t.hasPartial||e&&e.hasPartial||o).call(e,"textLong",{name:"hasPartial",hash:{},fn:this.program(9,n,0),inverse:this.program(11,n,0),data:n}))?a:"")+"    </div>\n</li>\n"},usePartial:!0,useData:!0}),this.Fiverr.Templates["notifications/notification-phone-verify"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a;return'<div class="phone-verify-notify js-phone-verify-notify gig-image">\n    <figure>\n        <div class="notification-icon phone"></div>\n    </figure>\n    <div class="content">\n        <label>\n            '+(null!=(a=(t.getI18nText||e&&e.getI18nText||t.helperMissing).call(e,"application.titles.phone_verification.notification.title",{name:"getI18nText",hash:{},data:n}))?a:"")+"\n        </label>\n    </div>\n</div>"},useData:!0}),this.Fiverr.Templates["notifications/notifications-drawer-item"]=Handlebars.template({1:function(e,t,i,n){return" unread"},3:function(e,t,i,n){return" gig-image"},5:function(e,t,i,n){var a;return'<a href="'+this.escapeExpression((a=null!=(a=t.url||(null!=e?e.url:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"url",hash:{},data:n}):a))+'" class="js-main-action"></a>'},7:function(e,t,i,n){return'<a href="#!" class="js-custom-action"></a>'},9:function(e,t,i,n){var a;return null!=(a=this.invokePartial(i["notification-aside-with-image"],e,{name:"notification-aside-with-image",data:n,indent:"        ",helpers:t,partials:i}))?a:""},11:function(e,t,i,n){var a;return null!=(a=this.invokePartial(i["notification-aside-basic"],e,{name:"notification-aside-basic",data:n,indent:"        ",helpers:t,partials:i}))?a:""},13:function(e,t,i,n){var a;return null!=(a=this.invokePartial(i["notification-user-image"],e,{name:"notification-user-image",data:n,indent:"        ",helpers:t,partials:i}))?a:""},15:function(e,t,i,n){var a;return null!=(a=this.invokePartial(i["notification-icon"],e,{name:"notification-icon",data:n,indent:"        ",helpers:t,partials:i}))?a:""},17:function(e,t,i,n){var a,r=this.lambda;return'            <p class="text-long"><strong>'+(null!=(a=r(null!=(a=null!=e?e.params:e)?a.user:a,e))?a:"")+'</strong>: "'+this.escapeExpression(r(null!=(a=null!=e?e.params:e)?a.message_content:a,e))+'"</p>\n'},19:function(e,t,i,n){var a;return"            <p>"+(null!=(a=(t.hasPartial||e&&e.hasPartial||t.helperMissing).call(e,"customContent",{name:"hasPartial",hash:{},fn:this.program(20,n,0),inverse:this.program(22,n,0),data:n}))?a:"")+"</p>\n"},20:function(e,t,i,n){var a;return null!=(a=this.lambda(null!=(a=null!=e?e.params:e)?a.content:a,e))?a:""},22:function(e,t,i,n){var a,r;return null!=(r=null!=(r=t.notificationContent||(null!=e?e.notificationContent:e))?r:t.helperMissing,a="function"==typeof r?r.call(e,{name:"notificationContent",hash:{},data:n}):r)?a:""},24:function(e,t,i,n){var a;return null!=(a=this.invokePartial(i["notification-footer-with-subcat"],e,{name:"notification-footer-with-subcat",data:n,indent:"            ",helpers:t,partials:i}))?a:""},26:function(e,t,i,n){var a;return null!=(a=this.invokePartial(i["notification-footer-basic"],e,{name:"notification-footer-basic",data:n,indent:"            ",helpers:t,partials:i}))?a:""},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a,r,o=t.helperMissing;return'<li class="notifications-message drawer-item'+(null!=(a=t.unless.call(e,null!=e?e.isRead:e,{name:"unless",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?a:"")+(null!=(a=t["if"].call(e,null!=(a=null!=e?e.images:e)?a.gig:a,{name:"if",hash:{},fn:this.program(3,n,0),inverse:this.noop,data:n}))?a:"")+'" data-id="'+this.escapeExpression((r=null!=(r=t.id||(null!=e?e.id:e))?r:o,"function"==typeof r?r.call(e,{name:"id",hash:{},data:n}):r))+'">\n    '+(null!=(a=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(5,n,0),inverse:this.noop,data:n}))?a:"")+"\n    "+(null!=(a=(t.hasPartial||e&&e.hasPartial||o).call(e,"customAction",{name:"hasPartial",hash:{},fn:this.program(7,n,0),inverse:this.noop,data:n}))?a:"")+"\n"+(null!=(a=(t.hasPartial||e&&e.hasPartial||o).call(e,"gigImage",{name:"hasPartial",hash:{},fn:this.program(9,n,0),inverse:this.program(11,n,0),data:n}))?a:"")+(null!=(a=(t.hasPartial||e&&e.hasPartial||o).call(e,"userImage",{name:"hasPartial",hash:{},fn:this.program(13,n,0),inverse:this.program(15,n,0),data:n}))?a:"")+'    <div class="content">\n'+(null!=(a=(t.hasPartial||e&&e.hasPartial||o).call(e,"textLong",{name:"hasPartial",hash:{},fn:this.program(17,n,0),inverse:this.program(19,n,0),data:n}))?a:"")+(null!=(a=(t.hasPartial||e&&e.hasPartial||o).call(e,"subCat",{name:"hasPartial",hash:{},fn:this.program(24,n,0),inverse:this.program(26,n,0),data:n}))?a:"")+"    </div>\n</li>\n"},usePartial:!0,useData:!0}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["notification-drawer"]=t():e["notification-drawer"]=t()}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=103)}({103:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=i(9),r=n(a),o=i(53),s=n(o),l=i(50),u=n(l),d=i(79),c=n(d);t["default"]=function(){Handlebars.registerHelper("deHyphenate",r["default"]),Handlebars.registerHelper("iconName",s["default"]),Handlebars.registerHelper("hasPartial",u["default"]),Handlebars.registerHelper("notificationContent",c["default"])}(),e.exports=t["default"]},50:function(e,t,i){"use strict";e.exports=function(e,t){var i=t.data.root.subType,n=notificationConfiguration(i);return n.hasOwnProperty(e)?t.fn(this):t.inverse(this)}},53:function(e,t,i){"use strict";e.exports=function(e){var t=e.data.root.subType,i=notificationConfiguration(t);return i.hasOwnProperty("icon")?i.icon:i.hasOwnProperty("dynamicIcon")?e.data.root.params.icon:"docs"}},79:function(e,t,i){"use strict";e.exports=function(e){var t=e.data.root;return $.t("notifications.content."+t.subType,t.params||{})}},9:function(e,t,i){"use strict";e.exports=function(e){return e.replace(/-/g," ")}}})}),function(e){MixpanelWrapper.bindLink('.js-show-tab[data-show-tab="inbox"]',MixpanelWrapper.Events.ConversationsEvents.OPENED_INBOX_PREVIEW);var t,i,n,a,r=0===e(".js-notification-drawer").length,o=0===e(".js-hover-drawer").length,s="inbox",l="notifications",u="recent",d="loadMore",c="initial",f="pull-up",p="pull-down",m="locked",g="loading-stripe",h="drawer-item",v="nochange",b="bounce",w="new",y="refresh",k="itemList",I="itemStore",C={delay:250},x={config:{ajaxCounter:0,pageSize:10,hoverDrawerHeight:532,requestInterval:5e3,timestampPlaceHolder:":timestamp:",routes:{inbox:{markAsRead:Fiverr.models.ps.markConversationAsReadUrl,markAsUnread:Fiverr.models.ps.markConversationAsUnreadUrl,preview:Fiverr.models.ps.previewConversationDefaultTimestampUrl},notifications:{markAsRead:Fiverr.models.ps.markNotificationAsReadUrl,markAsUnread:Fiverr.models.ps.markNotificationAsUnreadUrl,preview:Fiverr.models.ps.previewNotificationDefaultTimestampUrl}}},hasRecentRequestExpired:function(e){var i=t.recentRequest(e).get("time");return!i||i&&M.isBeforeNow(i+a.requestInterval)},recentRequest:function(e){return store.drawers.getIn(e,["recentRequest"])},getItems:function(e){t.isBeforeInitialRequest(e)?t.getInitial(e):t.getRecent(e)},getRecent:function(e){t.hasRecentRequestExpired(e)&&D.getRecent(e)},handleRealTimeItem:function(e){return D.handleRealTimeItem(e)},handleSingleItem:function(e){return D.handleSingleItem(e)},isBeforeInitialRequest:function(e){var i=t.recentRequest(e);return!i.get("time")},getInitial:function(e){t.hasRecentRequestExpired(e)&&(D.getInitial(e),T.drawer.showLoading(e))},loadMore:function(e,t){D.loadMore(e,t)},toggleRead:function(e,t){var i=D.getItemContainer(e),n=i.itemStore,a=n.get(t);a=a.toggleRead()},getSubType:function(e,t){var i=D.getItemContainer(e),n=i.itemStore,a=n.get(t);return a.subType},getNotificationCount:function(e){var t=D.getItemContainer(e),i=t.itemList;return i.length},renderBunch:function(e,t,i){var n=D.getItemContainer(e),r=n.itemList,o=n.itemStore,t=t||a.pageSize,i=i||0;r=r.skip(i),r=r.take(t),r.forEach(function(e){"dummy"!==e&&T.item.addToView(o.get(e))})},localRefresh:function(e,t){var i=!0,n=D.getItemContainer(e),a=n.itemStore;a.has(t)&&T.item.addToView(a.get(t),i)},disableLoadMore:function(e){T.drawer.toggleLoadMore(e,!1),T.hoverDrawer.should(T.hoverDrawer.disableLoadMore,[e])},initialListIsEmpty:function(e,i){var n=!0;t.disableLoadMore(e),T.drawer.toggleEmptyState(e,n,i),T.hoverDrawer.should(T.hoverDrawer.turnHoverToRedirect,[e])},itemsAddedToEmptyList:function(e){var t=!1;T.drawer.toggleEmptyState(e,t)},updateTotalUnreadCount:function(e,t){T.drawer.updateTotalUnreadCount(e,t),T.notificationMarkers.toggleMarker(e,!!t)}},D={models:{ps:Fiverr.models.ps,user:Fiverr.models.user,drawers:{},store:Immutable.Map.of("drawers",Immutable.Map())},init:function(){store.set("itemTypes",Immutable.List.of(l,s)),store.get("itemTypes").forEach(function(e){var t={itemStore:{},itemList:[],recentRequest:{time:0,requestedData:null},unreadCount:0};store.set(e,Immutable.fromJS(t))})},getCorrectDataName:function(e){return e===s?"conversations":l},getItemContainer:function(e){var t=store.get(e);return{itemList:t.get(k),itemStore:t.get(I)}},updateRecentRequest:function(e,t){var i=store.drawers.getIn(e,["recentRequest"]),n={recentRequest:{}};if(t!=d){var a=Date.now();n.recentRequest.time=a}else n.recentRequest.time=i.get("time");n.recentRequest.requestedData=t,store.drawers.merge(e,n)},postUpdateRead:function(i,n,r){var o=n?a.routes[i].markAsRead:a.routes[i].markAsUnread;e.ajax({type:"post",url:o,data:{id:r}}),t.localRefresh(i,r)},incrementTotalUnreadCount:function(e,t){var i=D.getTotalUnreadCount(e);i+=t,0>i&&(i=0),D.updateTotalUnreadCount(e,i)},updateTotalUnreadCount:function(e,n){var r=e+"UnreadUpdateDelay";n=n||0,clearTimeout(i[r]),i[r]=setTimeout(function(){store.drawers.updateIn(e,["unreadCount"],n),t.updateTotalUnreadCount(e,n),2===a.ajaxCounter&&(T.hoverDrawer.openInboxDrawer("inbox"),a.ajaxCounter=0)},50)},getTotalUnreadCount:function(e){return unreadCount=store.drawers.getIn(e,["unreadCount"])},getInitial:function(e){var i=!0,n=0,r=D.addTimestampToPreviewUrl(e,n),o=D.getCorrectDataName(e);D.updateRecentRequest(e,c),D.getItemsAjax(e,r,function(n){var r=n.service_unavailable||!1;return _.isEmpty(n[o])?t.initialListIsEmpty(e,r):(t.itemsAddedToEmptyList(e),_.size(n[o])<=a.pageSize&&t.disableLoadMore(e),n[o].forEach(function(t){D.newItem(e,t,i)}),void D.itemsReady(e))})},getRecent:function(e){D.updateRecentRequest(e,u);var i,n=D.getItemContainer(e),a=n.itemList,r=n.itemStore,o=0,s=D.getCorrectDataName(e),l=!a.isEmpty();if(l&&r.has(a.get(0))){var d=a.first();o=store.item.getById(e,d).updatedAt,o=M.msToSconds(o)}i=D.addTimestampToPreviewUrl(e,o),D.getItemsAjax(e,i,function(i){_.isEmpty(i[s])||(l&&t.itemsAddedToEmptyList(e),i[s].forEach(D.handleSingleItem))})},handleRealTimeItem:function(e){var t=e.type||e.msg_type||l;return D.newItem(t,e,!1)},handleSingleItem:function(e){var i=e.type||e.msg_type||l,n=t.isBeforeInitialRequest(i);if(n){var e=D.newItem(i,e,n);return t.getItems(i),D.itemsReady(i,1),e}D.updateRecentRequest(i,u);var a=store.item.getById(i,e.id),r=D.getItemContainer(i),o=r.itemList;if(!a)return e=D.newItem(i,e,n),D.itemsReady(i,1),e;if(a.fastForward(e),a.state===b){var s=o.findIndex(function(e){return e===a.id});o=o.splice(s,1),o=o.unshift(a.id),store.drawers.updateIn(i,[k],o)}return e=store.item.getById(i,e.id),D.itemsReady(i,1),e},getItemsAjax:function(t,i,n){e.ajax({dataType:"json",type:"get",url:i,success:function(e){var i=e.unread_conversations_count||e.unread_notifications_count;a.ajaxCounter++,Fiverr._nullOrUndefined(i)&&(i=0),D.updateTotalUnreadCount(t,i),n(e)}})},addTimestampToPreviewUrl:function(e,t){return a.routes[e].preview.replace(a.timestampPlaceHolder,t)},loadMore:function(e,i){var n=D.getItemContainer(e),r=n.itemList;D.updateRecentRequest(e,d),r.has(i)?(t.renderBunch(e,a.pageSize,i),D.canLoadMore(e,i)||t.disableLoadMore(e)):t.disableLoadMore(e)},canLoadMore:function(e,t){var i=D.getItemContainer(e),n=i.itemList,r=t+a.pageSize;return n.has(r)},itemsReady:function(e,i){t.renderBunch(e,i||0)},newItem:function(e,i,n){var a=new D.item(i);if(t.isBeforeInitialRequest(a.type))return a;var r=D.getItemContainer(a.type);r.itemList,r.itemStore,a.id;return store.item.add(e,a,n),a},item:function(e){this.fastForward(e)}},T={selectors:{$body:Fiverr.selectors.$body||e("body"),$headerWrapper:Fiverr.selectors.$mainHeader||e("#main-wrapper-header")},init:function(){n.$mainHeader=Fiverr.selectors.$jsHeader,T.drawer.init(),T.hoverDrawer.init(),T.notificationMarkers.init()},drawer:{init:function(){n.$allNotificationDrawers=e(".js-notification-drawer"),n.notificationDrawers={},n.$allNotificationDrawers.each(function(t,i){var n=e(i),a=n.data("type"),r=T.drawer.get(a);r?(r.off(),T.drawer.set(a,r.add(n)),T.drawer.bindActions(a)):(T.drawer.set(a,n),T.drawer.bindActions(a))})},get:function(e){return n.notificationDrawers[e]},set:function(e,t){n.notificationDrawers[e]=t},bindActions:function(i){var n=T.drawer.get(i);n.on("click","nav a",function(n){n.preventDefault();var a=e(n.target).closest("."+h),r=a.data("id"),o="unread",s="item_mark_",l=a.hasClass(o);t.toggleRead(i,r),s+=l?"read":o,M.track(i,s)}),n.on("click","a.js-main-action",function(){M.track(i,"item_click")}),n.on("click","a.js-custom-action",function(n){n.preventDefault();var a=e(n.target).closest("."+h),r=a.data("id"),o=a.hasClass("unread"),s=t.getSubType(i,r);switch(o&&t.toggleRead(i,r),s){case"optional_phone_verification":fLoader({load:["//assetsv2.fiverrcdn.com/assets/phone-verification-notification.js-f86332426be037e5c953b545e8f2c394.erb"],complete:function(){fPhoneVerificationNotification.optional(n)}})}}),n.next(".js-load-more").on("click",function(e){e.preventDefault(),T.drawer.loadMore(i)}),n.on("attach",_.debounce(function(){T.drawer.toggleLoadMore(i,!0)},50))},updateTotalUnreadCount:function(e,t){var i=T.drawer.get(e);!r&&i&&i.length&&(i.data("totalUnreadCount",t),T.hoverDrawer.should(T.hoverDrawer.updateTotalUnreadCount,[e,t]),i.trigger("unreadCountUpdated",{type:e,count:t}))},showLoading:function(e){var t=T.drawer.get(e),i=g;!r&&t&&t.length&&(t.addClass(i),setTimeout(function(){t.removeClass(i)},1e3))},toggleLoadMore:function(e,t){if(!r){var i=T.drawer.get(e);if(i&&i.length){var n="js-load-more",a=i.next("."+n),o="removed";t?a.removeClass(o):a.hasClass(o)?a.remove():(a.removeClass(n).addClass(o),a.on("transitionend",function(){a.remove()}))}}},toggleEmptyState:function(e,t,i){var n=T.drawer.get(e);if(!r&&n&&n.length){var a=n.parent();a.toggleClass("drawer-empty",t),i&&t&&a.addClass("unavailable")}},getItems:function(e,i){t.getItems(e),T.drawer.updateAllTimestamps(e),"function"==typeof i&&i()},loadMore:function(i){var n={},a=T.drawer.get(i).find("."+h).filter(function(){var t=e(this),i=t.data("id");return n[i]?!1:(n[i]=!0,!0)}),r=a.length;t.loadMore(i,r),M.track(i,"load-more")},updateAllTimestamps:function(e){var t=T.drawer.get(e),i=t.data("recentTimeTagUpdate"),n=Date.now();(!i||M.isBeforeNow(i+6e4))&&(T.drawer.iterateItemsAndCallback(e,T.item.refreshTimeTag),t.data("recentTimeTagUpdate",n))},iterateItemsAndCallback:function(t,i){var n=T.drawer.get(t),a=n.find("."+h);a.each(function(n,a){i(t,e(a))})}},item:{find:function(e,t){var i,n=T.drawer.get(e);if(n&&n.length)return i=n.find('.drawer-item[data-id="'+t+'"]')},renderTemplate:function(t){var i=s;notificationConfiguration(t.subType)&&(i=l);var n=Fiverr._getHbTemplate({tplType:l,tplName:i+"-"+h,tplData:t});return e(n)},addToView:function(e,t){var i,n=e.type,a=e.id,r=T.drawer.get(n);(t||T.item.shouldRender(e))&&(i=T.item.renderTemplate(e),e.state===b?T.item.bounce(n,a,i):t||e.state===y?T.item.refresh(n,a,i):T.item.attach(e,i),M.view.trimLongText(r,i),r.removeClass(g).trigger("addToView"))},shouldRender:function(e){var t=e.type,i=e.id,n=e.state!==v,a=T.item.find(t,i);return n?!0:!a.length},removeDuplicates:function(e,t){var i=T.item.find(e,t);i.remove()},attach:function(e,i){var n=e.type,a=e.id,r=T.drawer.get(n),o=t.recentRequest(n).get("requestedData"),s=o&&o!==u,l=o&&o===d;if(e.state===b)T.item.removeDuplicates(n,a),r.prepend(i);else if(e.state===w)T.item.removeDuplicates(n,a),s?r.append(i):r.prepend(i);else{if(e.state!==v||!l)return;T.item.removeDuplicates(n,a),r.append(i)}r.trigger("attach")},refresh:function(e,t,i){var n=T.item.find(e,t);n.replaceWith(i)},bounce:function(e,t,i){var n;$drawer=T.drawer.get(e),n=T.item.find(e,t),n.remove(),i.css("visibility","hidden"),i.css("visibility",""),$drawer.prepend(i)},refreshTimeTag:function(e,t){var i=t.find("time"),n=parseInt(i.attr("datetime"),10),a=Fiverr.howLongAgo(n);i.text(a)}},hoverDrawer:{init:function(){var t=function(t,i,a){var r=e(i),o=a?"."+a+" ":"",s=r.find("> header"),l=s.find(o+".js-view-link"),u=s.find(o+".js-total-unread-count"),d=r.find(o+".js-notification-drawer"),c=d.closest("li"),f=c.find(".js-hover-drawer-trigger"),p=r.find(o+".antiscroll-wrap"),m=r.find(o+".antiscroll-inner"),g=a||c.data("mark");n.hoverDrawer[g]={$trigger:f,$hoverDrawer:r,$header:s,$viewLink:l,$unreadCount:u,$drawer:d,$parent:c,$scroll:p,$scrollInn:m,state:0},T.hoverDrawer.bindEvents(g),T.selectors.hoverDrawer[g].$trigger.removeAttr("disabled")};Fiverr.models.browser.isMobileResponsive||(n.hoverDrawer={},n.$mainHeader.find(".js-hover-drawer [data-tab]").each(function(i,n){var a=e(n);t(i,a.closest(".js-hover-drawer"),a.data("tab"))}))},should:function(e,t){var i=!Fiverr.models.browser.isMobileResponsive;i&&e.apply(this,t)},updateTotalUnreadCount:function(e,t){var i=n.hoverDrawer[e];if(!o&&i&&i.length){var a=i.$unreadCount,r="";t&&(r="("+t+")"),a.text(r)}},closeDrawer:function(e){var t=n.hoverDrawer[e],i=t.$hoverDrawer;i.addClass("hidden"),t.state=0,T.hoverDrawer.offEventsOnClose(e)},openDrawer:function(e){var t=n.hoverDrawer[e],i=t.$hoverDrawer;i.removeClass("hidden"),t.state=1,T.drawer.getItems(e),T.hoverDrawer.onHoverDrawerOpen(e),setTimeout(function(){T.hoverDrawer.bindFakeModal(e)},0)},openInboxDrawer:function(e){var t=store.drawers.getIn("inbox",["unreadCount"]),i=store.drawers.getIn("notifications",["unreadCount"]);0===i&&t>0&&T.hoverDrawer.showInboxDrawer()},showInboxDrawer:function(){var t=e('[data-event-type="notifications"]'),i=e('[data-event-type="inbox"]'),n=e('[data-tab="notifications"]'),a=e('[data-tab="inbox"]');t.removeClass("selected"),i.addClass("selected"),n.addClass("hidden"),a.removeClass("hidden")},toggleHideDrawer:function(e){var t=n.hoverDrawer[e];1===t.state?T.hoverDrawer.closeDrawer(e):T.hoverDrawer.openDrawer(e),t.$parent.toggleClass("open",!!t.state)},redirectToViewPage:function(e){var t=n.hoverDrawer[e],i=t.$viewLink.prop("href");i&&(window.location=i)},bindFakeModal:function(t){n.$body.on("click.fakeModal",function(i){var n=e(i.target),a=!(n.closest(".js-hover-drawer").length+n.closest("."+h).length);a&&T.hoverDrawer.closeDrawer(t)}),n.$body.on("keyup.fakeModal",function(e){27===e.keyCode&&T.hoverDrawer.closeDrawer(t)})},offEventsOnClose:function(e){n.hoverDrawer[e];n.$body.off("click.fakeModal"),n.$body.off("keyup.fakeModal"),T.hoverDrawer.destoryScrollBar(e)},bindEvents:function(t){var i=n.hoverDrawer[t],a=i.$hoverDrawer,r=i.$drawer,o=i.$scrollInn;i.$trigger.on("click",function(e){e.preventDefault(),T.hoverDrawer.toggleHideDrawer(t)}),i.$trigger.on("mouseenter",function(e){T.drawer.getItems(s),T.drawer.getItems(l)}),i.$hoverDrawer.find(".js-show-tab").on("click",function(t){t.preventDefault();var i=e(this);e(".js-show-tab").removeClass("selected"),i.addClass("selected"),e(".js-notifications-wrapper").addClass("hidden"),e(".js-notifications-wrapper."+i.data("show-tab")).removeClass("hidden"),e(".js-see-all").addClass("hidden"),e(".js-see-all."+i.data("show-tab")).removeClass("hidden")}),r.on("attach",_.debounce(function(){T.hoverDrawer.attachScrollBar(t)},500)),i.$scrollInn.on("hitBottom",_.throttle(function(){a.hasClass(f)||(a.addClass(f).data(m,!0),setTimeout(function(){T.drawer.loadMore(t)},500),T.hoverDrawer.relaseAndUnlockDrawer(t))},1e3)),i.$scrollInn.on("hitTop",_.throttle(function(){a.hasClass(p)||a.data(m)||(a.addClass(p).data(m,!0),T.drawer.showLoading(t),T.drawer.getItems(t),T.hoverDrawer.relaseAndUnlockDrawer(t))},250)),a.on("click",".js-track",function(i){var n,a=e(this);a.hasClass("btn-see-all")?n="see_all":a.hasClass("js-view-link")?n="view_"+t:a.hasClass("account-settings")&&(n="notification_settings"),M.track(t,n)}),Fiverr.stopMouseWheel(o)},onHoverDrawerOpen:function(e){var t=T.drawer.get(e);T.drawer.updateAllTimestamps(e),M.view.trimLongText(t),T.hoverDrawer.attachScrollBar(e),M.track(e,"open")},relaseAndUnlockDrawer:function(e){var t=n.hoverDrawer[e],i=t.$hoverDrawer;setTimeout(function(){i.removeClass(f+" "+p),setTimeout(function(){i.data(m,!1)},1e3)},1e3)},destoryScrollBar:function(e){var t=n.hoverDrawer[e],i=t.$scroll;i.data("initialized",null),i.data("antiscroll")&&i.data("antiscroll").destroy()},attachScrollBar:function(e){var t=n.hoverDrawer[e],i=t.$drawer,r=i.outerHeight(),o=t.$scroll,s=o.data("initialized");!s&&r>a.hoverDrawerHeight&&(o.antiscroll(),o.data("initialized",!0))},turnHoverToRedirect:function(e){if(e===s){var t=n.hoverDrawer[e];if(t){var i=t.$hoverDrawer;t.length&&(t.state?T.hoverDrawer.redirectToViewPage(e):i.data("redirect",!0))}}},disableLoadMore:function(e){var i=n.hoverDrawer[e];if(i&&i.length){t.getNotificationCount(e);i.$scrollInn.off("hitBottom")}}},notificationMarkers:{init:function(){Fiverr.models.browser.isMobileResponsive||(n.notificationMarkers={},n.notificationMarkers.$all=n.$mainHeader.find(".js-mark"),n.notificationMarkers.$all.each(function(t,i){var a=e(i),r=a.data("mark");r&&(n.notificationMarkers[r]=a)}),n.notificationMarkers[l]=n.notificationMarkers[s])},toggleMarker:function(e,t){if(!Fiverr.models.browser.isMobileResponsive&&!o){var i=n.notificationMarkers[e],a=i.hasClass("marked")!==t;a&&(i.toggleClass("marked",t),e===l&&t&&(e=s),T.notificationMarkers.toggleLs(e,t))}},toggleLs:function(e,t){var i="header_data_markers",n=ft.utl.getLS(i);n&&(n.markedStatuses[e]=t,ft.utl.setLS(i,n))}}},M={secondsToMs:function(e){return 1e3*e},msToSconds:function(e){return parseInt(e/1e3,10)},isBeforeNow:function(e){var t=Date.now();return t>e},track:function(e,t){if(e&&t){var i={};i[e+"_menu"]=t,Fiverr._reportAuxData(i),Fiverr.pushGoogleUniversalTag("drawers",e,t)}},view:{trimLongText:function(t,i){var n,a="p.text-long:not(.truncated)";n=i&&i.length?t.find('[data-id="'+i.data("id")+'"] p.text-long'):t.find(a),n.each(function(){var t=e(this);t.dotdotdot({wrap:"letter",watch:!1,height:45,ellipsis:'..."',callback:function(e){e?(t.removeClass("text-long"),t.addClass("truncated")):t.parents(".js-hover-drawer").length||t.removeClass("text-long")}})})}}};D.item.prototype={fastForward:function(e){if(e.id){var t=e.updatedAt||M.secondsToMs(e.updated_at),i=e.type===s||e.msg_type===s,n=this.id;if(i)var a=M.secondsToMs(e.recipient_updated_at),r=(e.isOnline||e.is_online,this.isOnline!==e.isOnline);if(n)if(this.updatedAt===t){if(!r)return void(this.state=v);this.state=y}else this.state=b;else this.state=w;i?(this.isSender=t>a,this.recipientUpdatedAt=a,this.snippet=e.preview_text||"",this.username=e.username||null,this.isOnline=e.is_online||!1,this.type=s,this.subType=s):(this.params=e.msg_params,this.type=this.type||e.type||e.msg_type||l,this.subType=e.subType||e.sub_type),this.id=e.id,this.images=e.images||{},this.updatedAt=t||null,this.unreadCount=e.unreadCount||e.unread_count||0,this.isRead=e.isRead||e.is_read,Fiverr._nullOrUndefined(this.isRead)&&(this.isRead=!this.unreadCount),e.url&&(this.url=e.url),n&&store.item.update(this.type,this),onNewItemActions(this)}},toggleRead:function(){var e,t=Date.now();if(!(this.toggleWait&&t<this.toggleWait))return this.toggleWait=t+150,this.isRead?(this.isRead=!1,e=1):(this.isRead=!0,e=-1),this.unreadCount=0,D.postUpdateRead(this.type,this.isRead,this.id),D.incrementTotalUnreadCount(this.type,e),store.item.update(this.type,this),this}},x.store={get:function(e){return i.store.get(e)},set:function(e,t){i.store=i.store.set(e,t)},update:function(e,t){i.store=i.store.update(e,function(){return t})},drawers:{getIn:function(e,t){return store.get(e).getIn(t)},updateIn:function(e,t,i){var n=store.get(e).updateIn(t,function(){return i});store.update(e,n)},merge:function(e,t){var i=store.get(e);i=i.mergeDeep(t),store.update(e,i)}},item:{add:function(e,t,i){var n=store.get(e),a=n.get(I),r=n.get(k),o=t.id;a=a.set(o,t),r=i?r.push(o):r.unshift(o),store.drawers.updateIn(e,[I],a),store.drawers.updateIn(e,[k],r)},getById:function(e,t){var i=store.drawers.getIn(e,[I]);return i.get(t)},update:function(e,t){store.drawers.updateIn(e,[I,t.id],t)}}},onNewItemActions=function(e){var t,i;if(C.data?i=C.data:(C.data=Fiverr.getUserLS("recentInteractions")||[],i=C.data),e.username?t=e.username:e.params&&(t=e.params.seller||e.params.user||e.params.buyer),t){if(i.length){var n=i.indexOf(t);n>-1&&i.splice(n,1)}i.unshift(t),i.length>250&&(i.length=250),clearTimeout(C.timeOut),C.timeOut=setTimeout(function(){Fiverr.setUserLS("recentInteractions",i),Fiverr.setUserLS("interactionsDataDate",Date.now()+2592e5),delete C.data},C.delay)}},t=x,store=t.store,i=D.models,a=t.config,n=T.selectors,window.fNotificationsShared={helpers:M},window.fNotificationDrawer=x,D.init(),r||(T.init(),Fiverr.models.browser.isMobileResponsive||setTimeout(function(){var e=Fiverr.getUserLS("interactionsDataDate");(!e||M.isBeforeNow(e))&&(t.getItems(s),t.getItems(l))},1e3))}(jQuery);